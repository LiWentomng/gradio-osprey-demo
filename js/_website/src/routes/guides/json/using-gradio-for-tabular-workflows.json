{"guide": {"name": "using-gradio-for-tabular-workflows", "category": "tabular-data-science-and-plots", "pretty_category": "Tabular Data Science And Plots", "guide_index": null, "absolute_index": 25, "pretty_name": "Using Gradio For Tabular Workflows", "content": "##\u00a0Using Gradio for Tabular Data Science Workflows\n\nRelated spaces: https://huggingface.co/spaces/scikit-learn/gradio-skops-integration, https://huggingface.co/spaces/scikit-learn/tabular-playground, https://huggingface.co/spaces/merve/gradio-analysis-dashboard\n\n\n## Introduction\n\nTabular data science is the most widely used domain of machine learning, with problems ranging from customer segmentation to churn prediction. Throughout various stages of the tabular data science workflow, communicating your work to stakeholders or clients can be cumbersome; which prevents data scientists from focusing on what matters, such as data analysis and model building. Data scientists can end up spending hours building a dashboard that takes in dataframe and returning plots, or returning a prediction or plot of clusters in a dataset. In this guide, we'll go through how to use `gradio` to improve your data science workflows. We will also talk about how to use `gradio` and [skops](https://skops.readthedocs.io/en/stable/) to build interfaces with only one line of code!\n\n###\u00a0Prerequisites\n\nMake sure you have the `gradio` Python package already [installed](/getting_started).\n\n## Let's Create a Simple Interface!\n\nWe will take a look at how we can create a simple UI that predicts failures based on product information. \n\n```python\nimport gradio as gr\nimport pandas as pd\nimport joblib\nimport datasets\n\n\ninputs = [gr.Dataframe(row_count = (2, \"dynamic\"), col_count=(4,\"dynamic\"), label=\"Input Data\", interactive=1)]\n\noutputs = [gr.Dataframe(row_count = (2, \"dynamic\"), col_count=(1, \"fixed\"), label=\"Predictions\", headers=[\"Failures\"])]\n\nmodel = joblib.load(\"model.pkl\")\n\n# we will give our dataframe as example\ndf = datasets.load_dataset(\"merve/supersoaker-failures\")\ndf = df[\"train\"].to_pandas()\n\ndef infer(input_dataframe):\n  return pd.DataFrame(model.predict(input_dataframe))\n  \ngr.Interface(fn = infer, inputs = inputs, outputs = outputs, examples = [[df.head(2)]]).launch()\n```\n\nLet's break down above code.\n\n* `fn`: the inference function that takes input dataframe and returns predictions.\n* `inputs`: the component we take our input with. We define our input as dataframe with 2 rows and 4 columns, which initially will look like an empty dataframe with the aforementioned shape. When the `row_count` is set to `dynamic`, you don't have to rely on the dataset you're inputting to pre-defined component.\n* `outputs`: The dataframe component that stores outputs. This UI can take single or multiple samples to infer, and returns 0 or 1 for each sample in one column, so we give `row_count` as 2 and `col_count` as 1 above. `headers` is a list made of header names for dataframe.\n* `examples`: You can either pass the input by dragging and dropping a CSV file, or a pandas DataFrame through examples, which headers will be automatically taken by the interface.\n\nWe will now create an example for a minimal data visualization dashboard. You can find a more comprehensive version in the related Spaces.\n\n<gradio-app space=\"gradio/tabular-playground\"></gradio-app>\n\n```python\nimport gradio as gr\nimport pandas as pd\nimport datasets\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\ndf = datasets.load_dataset(\"merve/supersoaker-failures\")\ndf = df[\"train\"].to_pandas()\ndf.dropna(axis=0, inplace=True)\n\ndef plot(df):\n  plt.scatter(df.measurement_13, df.measurement_15, c = df.loading,alpha=0.5)\n  plt.savefig(\"scatter.png\")\n  df['failure'].value_counts().plot(kind='bar')\n  plt.savefig(\"bar.png\")\n  sns.heatmap(df.select_dtypes(include=\"number\").corr())\n  plt.savefig(\"corr.png\")\n  plots = [\"corr.png\",\"scatter.png\", \"bar.png\"]\n  return plots\n  \ninputs = [gr.Dataframe(label=\"Supersoaker Production Data\")]\noutputs = [gr.Gallery(label=\"Profiling Dashboard\").style(grid=(1,3))]\n\ngr.Interface(plot, inputs=inputs, outputs=outputs, examples=[df.head(100)], title=\"Supersoaker Failures Analysis Dashboard\").launch()\n```\n\n<gradio-app space=\"gradio/gradio-analysis-dashboard-minimal\"></gradio-app>\n\nWe will use the same dataset we used to train our model, but we will make a dashboard to visualize it this time. \n\n* `fn`: The function that will create plots based on data.\n* `inputs`: We use the same `Dataframe` component we used above.\n* `outputs`: The `Gallery` component is used to keep our visualizations.\n* `examples`: We will have the dataset itself as the example.\n\n## Easily load tabular data interfaces with one line of code using skops\n\n`skops` is a library built on top of `huggingface_hub` and `sklearn`. With the recent `gradio` integration of `skops`, you can build tabular data interfaces with one line of code!\n\n```python\nimport gradio as gr\n\n# title and description are optional\ntitle = \"Supersoaker Defective Product Prediction\"\ndescription = \"This model predicts Supersoaker production line failures. Drag and drop any slice from dataset or edit values as you wish in below dataframe component.\"\n\ngr.Interface.load(\"huggingface/scikit-learn/tabular-playground\", title=title, description=description).launch()\n```\n\n<gradio-app space=\"gradio/gradio-skops-integration\"></gradio-app>\n\n`sklearn` models pushed to Hugging Face Hub using `skops` include a `config.json` file that contains an example input  with column names, the task being solved (that can either be `tabular-classification` or `tabular-regression`). From the task type, `gradio` constructs the `Interface` and consumes column names and the example input to build it. You can [refer to skops documentation on hosting models on Hub](https://skops.readthedocs.io/en/latest/auto_examples/plot_hf_hub.html#sphx-glr-auto-examples-plot-hf-hub-py) to learn how to push your models to Hub using `skops`.\n", "html": "<h2 id=\"using-gradio-for-tabular-data-science-workflows\">\u00a0Using Gradio for Tabular Data Science Workflows</h2>\n\n<h2 id=\"introduction\">Introduction</h2>\n\n<p>Tabular data science is the most widely used domain of machine learning, with problems ranging from customer segmentation to churn prediction. Throughout various stages of the tabular data science workflow, communicating your work to stakeholders or clients can be cumbersome; which prevents data scientists from focusing on what matters, such as data analysis and model building. Data scientists can end up spending hours building a dashboard that takes in dataframe and returning plots, or returning a prediction or plot of clusters in a dataset. In this guide, we'll go through how to use <code>gradio</code> to improve your data science workflows. We will also talk about how to use <code>gradio</code> and <a rel=\"noopener\" target=\"_blank\" href=\"https://skops.readthedocs.io/en/stable/\">skops</a> to build interfaces with only one line of code!</p>\n\n<h3 id=\"prerequisites\">\u00a0Prerequisites</h3>\n\n<p>Make sure you have the <code>gradio</code> Python package already <a rel=\"noopener\" target=\"_blank\" href=\"/getting_started\">installed</a>.</p>\n\n<h2 id=\"lets-create-a-simple-interface\">Let's Create a Simple Interface!</h2>\n\n<p>We will take a look at how we can create a simple UI that predicts failures based on product information. </p>\n\n<div class='codeblock'><pre><code class='lang-python'>import gradio as gr\nimport pandas as pd\nimport joblib\nimport datasets\n\n\ninputs = [gr.Dataframe(row_count = (2, \"dynamic\"), col_count=(4,\"dynamic\"), label=\"Input Data\", interactive=1)]\n\noutputs = [gr.Dataframe(row_count = (2, \"dynamic\"), col_count=(1, \"fixed\"), label=\"Predictions\", headers=[\"Failures\"])]\n\nmodel = joblib.load(\"model.pkl\")\n\n# we will give our dataframe as example\ndf = datasets.load_dataset(\"merve/supersoaker-failures\")\ndf = df[\"train\"].to_pandas()\n\ndef infer(input_dataframe):\n  return pd.DataFrame(model.predict(input_dataframe))\n\ngr.Interface(fn = infer, inputs = inputs, outputs = outputs, examples = [[df.head(2)]]).launch()\n</code></pre></div>\n\n<p>Let's break down above code.</p>\n\n<ul>\n<li><code>fn</code>: the inference function that takes input dataframe and returns predictions.</li>\n<li><code>inputs</code>: the component we take our input with. We define our input as dataframe with 2 rows and 4 columns, which initially will look like an empty dataframe with the aforementioned shape. When the <code>row_count</code> is set to <code>dynamic</code>, you don't have to rely on the dataset you're inputting to pre-defined component.</li>\n<li><code>outputs</code>: The dataframe component that stores outputs. This UI can take single or multiple samples to infer, and returns 0 or 1 for each sample in one column, so we give <code>row_count</code> as 2 and <code>col_count</code> as 1 above. <code>headers</code> is a list made of header names for dataframe.</li>\n<li><code>examples</code>: You can either pass the input by dragging and dropping a CSV file, or a pandas DataFrame through examples, which headers will be automatically taken by the interface.</li>\n</ul>\n\n<p>We will now create an example for a minimal data visualization dashboard. You can find a more comprehensive version in the related Spaces.</p>\n\n<p><gradio-app space=\"gradio/tabular-playground\"></gradio-app></p>\n\n<div class='codeblock'><pre><code class='lang-python'>import gradio as gr\nimport pandas as pd\nimport datasets\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\ndf = datasets.load_dataset(\"merve/supersoaker-failures\")\ndf = df[\"train\"].to_pandas()\ndf.dropna(axis=0, inplace=True)\n\ndef plot(df):\n  plt.scatter(df.measurement_13, df.measurement_15, c = df.loading,alpha=0.5)\n  plt.savefig(\"scatter.png\")\n  df['failure'].value_counts().plot(kind='bar')\n  plt.savefig(\"bar.png\")\n  sns.heatmap(df.select_dtypes(include=\"number\").corr())\n  plt.savefig(\"corr.png\")\n  plots = [\"corr.png\",\"scatter.png\", \"bar.png\"]\n  return plots\n\ninputs = [gr.Dataframe(label=\"Supersoaker Production Data\")]\noutputs = [gr.Gallery(label=\"Profiling Dashboard\").style(grid=(1,3))]\n\ngr.Interface(plot, inputs=inputs, outputs=outputs, examples=[df.head(100)], title=\"Supersoaker Failures Analysis Dashboard\").launch()\n</code></pre></div>\n\n<p><gradio-app space=\"gradio/gradio-analysis-dashboard-minimal\"></gradio-app></p>\n\n<p>We will use the same dataset we used to train our model, but we will make a dashboard to visualize it this time. </p>\n\n<ul>\n<li><code>fn</code>: The function that will create plots based on data.</li>\n<li><code>inputs</code>: We use the same <code>Dataframe</code> component we used above.</li>\n<li><code>outputs</code>: The <code>Gallery</code> component is used to keep our visualizations.</li>\n<li><code>examples</code>: We will have the dataset itself as the example.</li>\n</ul>\n\n<h2 id=\"easily-load-tabular-data-interfaces-with-one-line-of-code-using-skops\">Easily load tabular data interfaces with one line of code using skops</h2>\n\n<p><code>skops</code> is a library built on top of <code>huggingface_hub</code> and <code>sklearn</code>. With the recent <code>gradio</code> integration of <code>skops</code>, you can build tabular data interfaces with one line of code!</p>\n\n<div class='codeblock'><pre><code class='lang-python'>import gradio as gr\n\n# title and description are optional\ntitle = \"Supersoaker Defective Product Prediction\"\ndescription = \"This model predicts Supersoaker production line failures. Drag and drop any slice from dataset or edit values as you wish in below dataframe component.\"\n\ngr.Interface.load(\"huggingface/scikit-learn/tabular-playground\", title=title, description=description).launch()\n</code></pre></div>\n\n<p><gradio-app space=\"gradio/gradio-skops-integration\"></gradio-app></p>\n\n<p><code>sklearn</code> models pushed to Hugging Face Hub using <code>skops</code> include a <code>config.json</code> file that contains an example input  with column names, the task being solved (that can either be <code>tabular-classification</code> or <code>tabular-regression</code>). From the task type, <code>gradio</code> constructs the <code>Interface</code> and consumes column names and the example input to build it. You can <a rel=\"noopener\" target=\"_blank\" href=\"https://skops.readthedocs.io/en/latest/auto_examples/plot_hf_hub.html#sphx-glr-auto-examples-plot-hf-hub-py\">refer to skops documentation on hosting models on Hub</a> to learn how to push your models to Hub using <code>skops</code>.</p>\n", "tags": [], "spaces": ["https://huggingface.co/spaces/scikit-learn/gradio-skops-integration", "https://huggingface.co/spaces/scikit-learn/tabular-playground", "https://huggingface.co/spaces/merve/gradio-analysis-dashboard"], "url": "/guides/using-gradio-for-tabular-workflows/", "contributor": null}}